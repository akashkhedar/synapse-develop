{% extends 'simple.html' %} {% load i18n %} {% load static %} {% load filters %}
{% block app-css %}
<!-- Disable react-app CSS on auth pages -->
{% endblock %}
{% block head %}
<style nonce="{{request.csp_nonce}}">
  /* Critical inline styles - Lambda-inspired design with pure black background */
  html, body { 
    margin: 0 !important; 
    padding: 0 !important; 
    background: #000000 !important;
    background-color: #000000 !important;
  }
  body::before, body::after {
    display: none !important;
  }
  .auth-page { 
    display: flex !important; 
    min-height: 100vh;
    align-items: center;
    justify-content: center;
    padding: 20px;
    background: #000000 !important;
    background-color: #000000 !important;
    font-family: 'Hellix', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
  }
  .auth-card {
    display: flex !important;
    flex-direction: row !important;
    max-width: 1200px;
    width: 100%;
    min-height: 700px;
    background: #fff !important;
    overflow: hidden;
    border-radius: 0 !important;
  }
  .auth-form-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    padding: 60px 80px;
    background: #F5F1E8 !important;
  }
  .auth-image-panel {
    flex: 1;
    position: relative;
    background: #1a1a2e !important;
    overflow: hidden;
  }
  .auth-image-wrapper {
    width: 100%;
    height: 100%;
  }
  .auth-image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    opacity: 0.95;
  }
</style>
<link
  rel="stylesheet"
  href="{{ settings.HOSTNAME }}{% static 'css/fonts.hellix.css' %}"
/>
<link
  rel="stylesheet"
  href="{{ settings.HOSTNAME }}{% static 'css/auth-pages.css' %}"
/>

<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-129877673-1"
  nonce="{{request.csp_nonce}}"
></script>
<script nonce="{{request.csp_nonce}}">
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "UA-129877673-1");
</script>
{% endblock %} {% block content %}
<script nonce="{{request.csp_nonce}}">
  window.APP_SETTINGS = window.APP_SETTINGS ?? {};
  window.APP_SETTINGS.collect_analytics = {{ settings.COLLECT_ANALYTICS|yesno:"true,false" }};

  // Log event to the server, if analytics are enabled
  // This is a fallback for when the __lsa global is not defined
  // Normally this is a part of our main bundle but these pages do not use the main bundle
  // and this allows us to log events from these pages
  const logEvent = (eventName, metadata = {}) => {
    if (!window.APP_SETTINGS?.collect_analytics) return;

    const payload = {
      ...metadata,
      event: eventName,
      url: window.location.href,
    };

    window.requestIdleCallback(() => {
      const params = new URLSearchParams({ __: JSON.stringify(payload) });
      const url = `/__lsa/?${params}`;
      try {
        if (navigator.sendBeacon) {
          navigator.sendBeacon(url);
        } else {
          const img = new Image();
          img.src = url;
        }
      } catch {
        // Ignore errors here
      }
    });
  };
  if (!window.__lsa) {
    window.__lsa = logEvent;
  }
</script>

<script nonce="{{request.csp_nonce}}">
  const gaClientIdTrackingIframe = (event) => {
    if (!window.APP_SETTINGS?.collect_analytics) return;

    const iframe = document.createElement("iframe");
    window.addEventListener("message", (message) => {
      if (message.source === iframe.contentWindow && message.data.gaClientId) {
        sessionStorage.setItem("ls_gaclient_id", message.data.gaClientId);
      }
    });
    const origin = window.location.origin;
    iframe.src = `https://synapse.io/track/?event=${event}&origin=${origin}`;
    iframe.style.display = "none";
    iframe.style.visibility = "hidden";
    document.body.appendChild(iframe);
  };
</script>

<div class="auth-page">
  <div class="auth-card">
    <div class="auth-form-panel">
      
      {% block user_content %}{% endblock %}
    </div>
    <div class="auth-image-panel">
      <div class="auth-image-wrapper">
        <img src="https://images.unsplash.com/photo-1622979135225-d2ba269cf1ac?w=1200&q=80" alt="VR Experience" />
      </div>
    </div>
  </div>
</div>

{% endblock %}
